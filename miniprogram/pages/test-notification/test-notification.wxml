<!--通知功能测试页面-->
<view class="container">
  <view class="header">
    <text class="title">通知功能测试</text>
    <text class="subtitle">测试通知管理器的各项功能</text>
  </view>

  <view class="test-buttons">
    <button class="test-btn primary" bindtap="runAllTests">运行所有测试</button>
    <button class="test-btn" bindtap="clearResults">清空结果</button>
  </view>

  <view class="test-sections">
    <view class="section">
      <text class="section-title">基础功能测试</text>
      <view class="button-group">
        <button class="test-btn small" bindtap="testGetSettings">获取设置</button>
        <button class="test-btn small" bindtap="testSaveSettings">保存设置</button>
        <button class="test-btn small" bindtap="testAddNotification">添加通知</button>
        <button class="test-btn small" bindtap="testGetNotifications">获取通知</button>
      </view>
    </view>

    <view class="section">
      <text class="section-title">通知操作测试</text>
      <view class="button-group">
        <button class="test-btn small" bindtap="testMarkRead">标记已读</button>
        <button class="test-btn small" bindtap="testMarkAllRead">全部已读</button>
        <button class="test-btn small" bindtap="testClearAll">清空通知</button>
      </view>
    </view>

    <view class="section">
      <text class="section-title">权限测试</text>
      <view class="button-group">
        <button class="test-btn small {{isLoading ? 'loading' : ''}}" bindtap="testSubscriptionPermission" disabled="{{isLoading}}">
          {{isLoading ? '申请中...' : '申请订阅权限'}}
        </button>
        <button class="test-btn small {{isLoading ? 'loading' : ''}}" bindtap="testSendSubscriptionMessage" disabled="{{isLoading}}">
          {{isLoading ? '发送中...' : '测试发送消息'}}
        </button>
      </view>
    </view>
  </view>

  <view class="results-container">
    <view class="results-header">
      <text class="results-title">测试结果 ({{testResults.length}})</text>
    </view>
    
    <scroll-view class="results-list" scroll-y="true">
      <view wx:for="{{testResults}}" wx:key="id" class="result-item {{item.type}}">
        <view class="result-content">
          <text class="result-message">{{item.message}}</text>
          <text class="result-time">{{item.time}}</text>
        </view>
        <view class="result-indicator {{item.type}}"></view>
      </view>
      
      <view wx:if="{{testResults.length === 0}}" class="empty-results">
        <text>暂无测试结果</text>
      </view>
    </scroll-view>
  </view>
</view>