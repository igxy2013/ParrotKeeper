<!--pages/index/index.wxml-->
<view class="page-container">
  <!-- å¤´éƒ¨æ¬¢è¿åŒºåŸŸ -->
  <view class="header-section">
    <view class="welcome-card">
      <view class="welcome-text">
        <text class="greeting">{{greeting}}</text>
        <text class="username">{{userInfo.nickname || 'é¹¦é¹‰çˆ±å¥½è€…'}}</text>
      </view>
      <view class="weather-info" wx:if="{{weather}}">
        <text class="temperature">{{weather.temperature}}Â°C</text>
        <text class="weather-desc">{{weather.description}}</text>
      </view>
    </view>
  </view>

  <!-- å¿«é€Ÿç»Ÿè®¡ -->
  <view class="stats-section">
    <view class="stats-grid">
      <view class="stat-item" bindtap="navigateToParrots">
        <view class="stat-number">{{overview.total_parrots || 0}}</view>
        <view class="stat-label">æˆ‘çš„é¹¦é¹‰</view>
      </view>
      <view class="stat-item" bindtap="navigateToRecords">
        <view class="stat-number">{{overview.today_records.feeding || 0}}</view>
        <view class="stat-label">ä»Šæ—¥å–‚é£Ÿ</view>
      </view>
      <view class="stat-item">
        <view class="stat-number">{{overview.health_status.healthy || 0}}</view>
        <view class="stat-label">å¥åº·é¹¦é¹‰</view>
      </view>
      <view class="stat-item">
        <view class="stat-number">Â¥{{overview.monthly_expense || 0}}</view>
        <view class="stat-label">æœ¬æœˆæ”¯å‡º</view>
      </view>
    </view>
  </view>

  <!-- å¿«é€Ÿæ“ä½œ -->
  <view class="quick-actions">
    <view class="card">
      <view class="card-header">
        <text class="card-title">å¿«é€Ÿæ“ä½œ</text>
      </view>
      <view class="card-content">
        <view class="action-grid">
          <view class="action-item {{!isLogin ? 'disabled' : ''}}" bindtap="quickFeeding">
            <view class="action-icon">ğŸ</view>
            <text class="action-text">å¿«é€Ÿå–‚é£Ÿ</text>
          </view>
          <view class="action-item {{!isLogin ? 'disabled' : ''}}" bindtap="quickCleaning">
            <view class="action-icon">ğŸ§½</view>
            <text class="action-text">æ¸…æ´è®°å½•</text>
          </view>
          <view class="action-item {{!isLogin ? 'disabled' : ''}}" bindtap="quickHealth">
            <view class="action-icon">ğŸ¥</view>
            <text class="action-text">å¥åº·æ£€æŸ¥</text>
          </view>
          <view class="action-item {{!isLogin ? 'disabled' : ''}}" bindtap="addParrot">
            <view class="action-icon">â•</view>
            <text class="action-text">æ·»åŠ é¹¦é¹‰</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- æœ€è¿‘è®°å½• -->
  <view class="recent-records" wx:if="{{recentRecords.length > 0}}">
    <view class="card">
      <view class="card-header">
        <text class="card-title">æœ€è¿‘è®°å½•</text>
        <text class="more-link" bindtap="viewAllRecords">æŸ¥çœ‹å…¨éƒ¨</text>
      </view>
      <view class="card-content">
        <view class="record-list">
          <view class="record-item" wx:for="{{recentRecords}}" wx:key="id">
            <view class="record-icon">
              <text wx:if="{{item.type === 'feeding'}}">ğŸ</text>
              <text wx:elif="{{item.type === 'health'}}">ğŸ¥</text>
              <text wx:elif="{{item.type === 'cleaning'}}">ğŸ§½</text>
              <text wx:elif="{{item.type === 'breeding'}}">ğŸ’•</text>
            </view>
            <view class="record-content">
              <view class="record-title">{{item.title}}</view>
              <view class="record-subtitle">{{item.parrot_name}} Â· {{item.time}}</view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- å¥åº·æé†’ -->
  <view class="health-alerts" wx:if="{{healthAlerts.length > 0}}">
    <view class="card">
      <view class="card-header">
        <text class="card-title">å¥åº·æé†’</text>
      </view>
      <view class="card-content">
        <view class="alert-list">
          <view class="alert-item" wx:for="{{healthAlerts}}" wx:key="id">
            <view class="alert-icon">âš ï¸</view>
            <view class="alert-content">
              <view class="alert-title">{{item.title}}</view>
              <view class="alert-subtitle">{{item.description}}</view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- ç™»å½•æç¤º -->
  <view class="login-prompt" wx:if="{{!isLogin}}">
    <view class="card">
      <view class="card-content">
        <view class="login-icon">ğŸ¦œ</view>
        <view class="login-text">æ¬¢è¿ä½¿ç”¨é¹¦é¹‰ç®¡å®¶</view>
        <view class="login-subtitle">è¯·å…ˆç™»å½•ä»¥ä½¿ç”¨å®Œæ•´åŠŸèƒ½</view>
        <button class="btn btn-primary btn-large mt-30" bindtap="handleLogin">å¾®ä¿¡å¿«é€Ÿç™»å½•</button>
      </view>
    </view>
  </view>
</view>