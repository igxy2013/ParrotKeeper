<!--pages/teams/teams.wxml-->
<view class="container">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="page-header">
    <view class="header-title">å›¢é˜Ÿåä½œ</view>
    <view class="header-subtitle">ç®¡ç†æ‚¨çš„å›¢é˜Ÿï¼Œæå‡åä½œæ•ˆç‡</view>
  </view>

  <!-- å›¢é˜Ÿä¿¡æ¯å¡ç‰‡ -->
  <view class="team-info-card">
    <view class="team-header">
      <view class="team-icon-wrapper">
        <view class="team-icon">ğŸ¦œ</view>
        <view class="team-status-indicator active"></view>
      </view>
      <view class="team-details">
        <view class="team-name">{{teamInfo.name}}</view>
        <view class="team-meta">
          <view class="create-info">
            <text class="create-time">åˆ›å»ºäº {{teamInfo.createTime}}</text>
            <view class="status-badge active">{{teamInfo.status}}</view>
          </view>
        </view>
      </view>
      <view class="team-actions">
        <view class="action-btn settings" bindtap="openSettings">
          <text class="action-icon">âš™ï¸</text>
        </view>
      </view>
    </view>
    
    <!-- ç»Ÿè®¡æ•°æ® -->
    <view class="stats-container">
      <view class="stat-item">
        <view class="stat-icon-bg members">
          <view class="stat-icon">ğŸ‘¥</view>
        </view>
        <view class="stat-content">
          <view class="stat-number">{{teamInfo.memberCount}}</view>
          <view class="stat-label">å›¢é˜Ÿæˆå‘˜</view>
        </view>
      </view>
      <view class="stat-item">
        <view class="stat-icon-bg records">
          <view class="stat-icon">ğŸ“</view>
        </view>
        <view class="stat-content">
          <view class="stat-number">{{teamInfo.recordCount}}</view>
          <view class="stat-label">é¥²å…»è®°å½•</view>
        </view>
      </view>
      <view class="stat-item">
        <view class="stat-icon-bg tasks">
          <view class="stat-icon">ğŸ“…</view>
        </view>
        <view class="stat-content">
          <view class="stat-number">{{teamInfo.todayTasks}}</view>
          <view class="stat-label">ä»Šæ—¥ä»»åŠ¡</view>
        </view>
      </view>
    </view>
  </view>

  <!-- å¿«é€Ÿæ“ä½œ -->
  <view class="section">
    <view class="section-header">
      <view class="section-title">
        <view class="title-icon">âš¡</view>
        <text>å¿«é€Ÿæ“ä½œ</text>
      </view>
    </view>
    <view class="quick-actions">
      <view class="action-item" data-id="invite" bindtap="onQuickActionTap" style="--action-color: #10b981">
        <view class="action-icon-wrapper"><view class="action-icon">ğŸ‘¤</view></view>
        <view class="action-content">
          <view class="action-name">é‚€è¯·æˆå‘˜</view>
        </view>
      </view>
      <view class="action-item" data-id="addRecord" bindtap="onQuickActionTap" style="--action-color: #60a5fa">
        <view class="action-icon-wrapper"><view class="action-icon">â•</view></view>
        <view class="action-content">
          <view class="action-name">æ·»åŠ è®°å½•</view>
        </view>
      </view>
      <view class="action-item" data-id="createTask" bindtap="onQuickActionTap" style="--action-color: #a78bfa">
        <view class="action-icon-wrapper"><view class="action-icon">ğŸ“…</view></view>
        <view class="action-content">
          <view class="action-name">åˆ›å»ºä»»åŠ¡</view>
        </view>
      </view>
      <view class="action-item" data-id="settings" bindtap="onQuickActionTap" style="--action-color: #fb923c">
        <view class="action-icon-wrapper"><view class="action-icon">âš™ï¸</view></view>
        <view class="action-content">
          <view class="action-name">å›¢é˜Ÿè®¾ç½®</view>
        </view>
      </view>
    </view>
  </view>

  <!-- å›¢é˜Ÿæˆå‘˜ -->
  <view class="section">
    <view class="section-header">
      <view class="section-title">
        <view class="title-icon">ğŸ‘¥</view>
        <text>å›¢é˜Ÿæˆå‘˜</text>
      </view>
      <view class="section-extra">
        <view class="member-count">{{members.length}}äºº</view>
        <view class="invite-btn-small" bindtap="inviteNewMember">é‚€è¯·æˆå‘˜</view>
      </view>
    </view>
    
    <view class="members-container">
      <!-- æœç´¢å’Œç­›é€‰ -->
      <view class="search-filter-section">
        <view class="search-bar">
          <view class="search-icon">ğŸ”</view>
          <input 
            class="search-input" 
            placeholder="æœç´¢æˆå‘˜å§“åæˆ–è§’è‰²"
            value="{{searchKeyword}}"
            bindinput="onSearchInput"
          />
          <view class="search-clear" wx:if="{{searchKeyword}}" bindtap="clearSearch">âœ•</view>
        </view>
        
        <view class="filter-tabs">
          <view 
            class="filter-tab {{selectedRole === 'all' ? 'active' : ''}}"
            data-role="all"
            bindtap="onRoleFilter"
          >
            å…¨éƒ¨
          </view>
          <view 
            class="filter-tab {{selectedRole === 'ç®¡ç†å‘˜' ? 'active' : ''}}"
            data-role="ç®¡ç†å‘˜"
            bindtap="onRoleFilter"
          >
            ç®¡ç†å‘˜
          </view>
          <view 
            class="filter-tab {{selectedRole === 'ç¼–è¾‘è€…' ? 'active' : ''}}"
            data-role="ç¼–è¾‘è€…"
            bindtap="onRoleFilter"
          >
            ç¼–è¾‘è€…
          </view>
          <view 
            class="filter-tab {{selectedRole === 'æˆå‘˜' ? 'active' : ''}}"
            data-role="æˆå‘˜"
            bindtap="onRoleFilter"
          >
            æˆå‘˜
          </view>
        </view>
      </view>

      <!-- åœ¨çº¿æˆå‘˜ç»Ÿè®¡ -->
      <view class="online-stats">
        <view class="online-indicator"></view>
        <text class="online-text">{{onlineMembersCount}}äººåœ¨çº¿</text>
      </view>

      <!-- æˆå‘˜åˆ—è¡¨ -->
      <view class="members-list">
        <view 
          class="member-item-detailed" 
          wx:for="{{filteredMembers}}" 
          wx:key="id"
          data-id="{{item.id}}"
          bindtap="onMemberTap"
        >
          <view class="member-main">
            <view class="member-avatar-section">
              <view class="member-avatar-container">
                <image class="member-avatar" src="{{item.avatar}}" mode="aspectFill"></image>
                <view class="online-status {{item.isOnline ? 'online' : 'offline'}}"></view>
              </view>
            </view>
            
            <view class="member-info-section">
              <view class="member-basic-info">
                <view class="member-name">{{item.name}}</view>
                <view class="member-role-badge {{item.role === 'ç®¡ç†å‘˜' ? 'admin' : item.role === 'ç¼–è¾‘è€…' ? 'editor' : 'member'}}">
                  <view class="role-icon">{{item.role === 'ç®¡ç†å‘˜' ? 'ğŸ‘‘' : item.role === 'ç¼–è¾‘è€…' ? 'âœï¸' : 'ğŸ‘¤'}}</view>
                  <text class="role-text">{{item.role}}</text>
                </view>
              </view>
              <view class="member-meta-info">
                <view class="meta-item">
                  <view class="meta-icon">ğŸ“…</view>
                  <text class="meta-text">åŠ å…¥äº {{item.joinTime}}</text>
                </view>
                <view class="meta-item">
                  <view class="meta-icon">â°</view>
                  <text class="meta-text">æœ€åæ´»è·ƒ: {{item.lastActive}}</text>
                </view>
              </view>
            </view>
          </view>
          
          <view class="member-actions">
            <view 
              class="action-btn primary"
              data-id="{{item.id}}"
              bindtap="manageMemberPermissions"
              catchtap="manageMemberPermissions"
            >
              <text class="action-icon">âš™ï¸</text>
            </view>
            <view 
              class="action-btn secondary"
              data-id="{{item.id}}"
              bindtap="viewMemberProfile"
              catchtap="viewMemberProfile"
            >
              <text class="action-icon">ğŸ‘ï¸</text>
            </view>
          </view>
        </view>
        
        <!-- ç©ºçŠ¶æ€ -->
        <view class="empty-state" wx:if="{{filteredMembers.length === 0}}">
          <view class="empty-icon">ğŸ‘¥</view>
          <view class="empty-text">æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„æˆå‘˜</view>
          <view class="empty-desc">å°è¯•è°ƒæ•´æœç´¢æ¡ä»¶æˆ–ç­›é€‰é€‰é¡¹</view>
          <view class="empty-action" bindtap="resetFilters">é‡ç½®ç­›é€‰</view>
        </view>
      </view>
    </view>
  </view>

  <!-- æœ€è¿‘æ´»åŠ¨ -->
  <view class="section">
    <view class="section-header">
      <view class="section-title">
        <view class="title-icon">ğŸ“Š</view>
        <text>æœ€è¿‘æ´»åŠ¨</text>
      </view>
    </view>
    <view class="activity-container">
      <view class="activity-item" wx:for="{{recentActivities}}" wx:key="id">
        <view class="activity-avatar">
          <image src="{{item.userAvatar}}" mode="aspectFill"></image>
        </view>
        <view class="activity-content">
          <view class="activity-text">
            <text class="user-name">{{item.userName}}</text>
            <text class="activity-desc">{{item.action}}</text>
          </view>
          <view class="activity-time">{{item.time}}</view>
        </view>
      </view>
      
      <view class="empty-activity" wx:if="{{!recentActivities || recentActivities.length === 0}}">
        <view class="empty-icon">ğŸ“</view>
        <view class="empty-text">æš‚æ— æœ€è¿‘æ´»åŠ¨</view>
        <view class="empty-desc">å›¢é˜Ÿæˆå‘˜çš„æ“ä½œè®°å½•å°†åœ¨è¿™é‡Œæ˜¾ç¤º</view>
      </view>
    </view>
  </view>
</view>