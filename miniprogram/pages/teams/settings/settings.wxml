<view class="container">
  <app-header title="团队设置" subtitle="管理团队信息与成员权限" showBack="{{true}}"></app-header>

  <view class="card">
    <view class="card-header">
      <text class="card-title">基本信息</text>
    </view>
    <view class="card-content">
      <view class="info-row">
        <text class="label">名称</text>
        <text class="value">{{team.name}}</text>
      </view>
      <view class="info-row">
        <text class="label">描述</text>
        <text class="value">{{team.description || '—'}}</text>
      </view>
      <view class="info-row">
        <text class="label">邀请码</text>
        <text class="value code">{{team.invite_code || '—'}}</text>
        <button class="btn btn-small" bindtap="copyInviteCode" wx:if="{{team.invite_code}}">复制</button>
      </view>
      <view class="info-row">
        <text class="label">我的角色</text>
        <text class="value">{{userRole === 'owner' ? '创建者' : (userRole === 'admin' ? '管理员' : '成员')}}</text>
      </view>
    </view>
  </view>

  <view class="card">
    <view class="card-header">
      <text class="card-title">成员管理</text>
    </view>
    <view class="card-content">
      <view class="member-item" wx:for="{{members}}" wx:key="id">
        <image class="avatar" src="{{item.avatar_url || '/images/default-avatar.png'}}" mode="aspectFill"></image>
        <view class="member-info">
          <text class="name">{{item.nickname}}</text>
          <text class="role">{{item.role === 'owner' ? '创建者' : (item.role === 'admin' ? '管理员' : '成员')}}</text>
        </view>
        <view class="actions" wx:if="{{userRole === 'owner' || userRole === 'admin'}}">
          <button class="btn btn-small" data-id="{{item.id}}" bindtap="onToggleRole" wx:if="{{item.role !== 'owner'}}">{{item.role === 'admin' ? '设为成员' : '设为管理员'}}</button>
          <button class="btn btn-small danger" data-id="{{item.id}}" bindtap="onRemoveMember" wx:if="{{item.role !== 'owner'}}">移除</button>
        </view>
      </view>
      <view class="empty" wx:if="{{members.length === 0}}">暂无成员</view>
    </view>
  </view>

  <view class="footer" wx:if="{{userRole !== 'owner'}}">
    <button class="btn btn-danger" bindtap="onLeaveTeam">离开团队</button>
  </view>
</view>
