为了帮助鹦鹉管家项目实现商业价值，我为您规划了一套 会员订阅体系（Membership Subscription System） 。该方案旨在在不破坏免费用户核心体验的前提下，为重度用户（如繁育者、多只鹦鹉持有者）提供高价值的增值服务。

以下是详细的规划方案：

### 一、 产品与商业设计 (Product & Business Design)
我们将用户分为三个层级： 免费版 (Free) 、 高级会员 (Pro) 和 团队/繁育版 (Team/Breeder) 。
 1. 权益对比表
功能权益 免费版 (Free) 高级会员 (Pro) 团队/繁育版 (Team) 鹦鹉数量限制 上限 5 只 无限制 无限制 数据记录 基础记录 (喂食/清洁/健康) 基础记录 + 高清照片原图存储 所有 Pro 功能 统计分析 基础月报 高级趋势图 (体重/食量/开销趋势) 多维度繁育报表 数据导出 不支持 导出 Excel/PDF 报表 批量导出备份 AI 智能助手 每日限 3 次 (语音/文本识别) 无限次使用 + 更精准模型 无限次 市场洞察 仅查看当前参考价 查看历史价格趋势图 市场行情深度分析 团队协作 仅限单人 单人 支持多成员协作管理 (员工/家人) 广告 可能有少量广告 纯净无广告 纯净无广告
 2. 定价策略建议 (仅供参考)
- 月卡 (Monthly) : ¥9.9 /月 (低门槛尝试)
- 年卡 (Yearly) : ¥99 /年 (约为月卡的 8.3 折，主推款)
- 终身会员 (Lifetime) : ¥299 (一次性买断，适合初期回笼资金)
### 二、 技术架构规划 (Technical Architecture)
为了支持上述业务，我们需要在数据库和后端逻辑上进行扩展。
 1. 数据库设计 (Schema Changes)
我们需要修改 users 表并新增 subscriptions 和 payment_orders 表。

A. 修改 User 模型 在 models.py 的 User 表中增加会员状态字段：

```
class User(db.Model):
    # ... 现有字段 ...
    
    # 会员相关字段
    subscription_tier = db.Column
    (db.Enum('free', 'pro', 
    'team'), default='free') # 当前
    等级
    subscription_expire_at = db.
    Column(db.DateTime, 
    nullable=True) # 过期时间
    is_auto_renew = db.Column(db.
    Boolean, default=False) # 是否自
    动续费
```
B. 新增 SubscriptionOrder 模型 (用于记录支付订单)

```
class SubscriptionOrder(db.Model):
    __tablename__ = 
    'subscription_orders'
    
    id = db.Column(db.Integer, 
    primary_key=True)
    user_id = db.Column(db.Integer, 
    db.ForeignKey('users.id'), 
    nullable=False)
    order_no = db.Column(db.String
    (64), unique=True, 
    nullable=False) # 内部订单号
    transaction_id = db.Column(db.
    String(64), nullable=True) # 微
    信支付流水号
    plan_id = db.Column(db.String
    (32), nullable=False) # 例如: 
    'pro_monthly', 'pro_yearly'
    amount = db.Column(db.Numeric
    (10, 2), nullable=False) # 支付
    金额
    status = db.Column(db.Enum
    ('pending', 'paid', 'failed', 
    'refunded'), default='pending')
    created_at = db.Column(db.
    DateTime, default=datetime.
    utcnow)
    paid_at = db.Column(db.
    DateTime, nullable=True)
``` 2. API 接口规划
我们需要在 backend/routes/ 下新建 subscription.py 模块：

方法 路径 描述 GET /api/subscription/plans 获取订阅套餐列表 (价格、描述) GET /api/subscription/status 获取当前用户订阅状态及过期时间 POST /api/subscription/create_order 创建支付订单 (对接微信支付统一下单) POST /api/subscription/wechat_callback 接收微信支付异步通知，更新订单状态和用户权益
 3. 权限控制逻辑 (Gatekeeper Logic)
我们需要一个装饰器或检查函数，在关键操作前检查权限。例如在 parrots.py 中：

```
# 伪代码示例
def check_parrot_limit(user):
    if user.subscription_tier == 
    'free':
        count = Parrot.query.
        filter_by(user_id=user.id).
        count()
        if count >= 5:
            raise PermissionError("
            免费版最多添加5只鹦鹉，请升
            级会员解锁无限数量")
```
### 三、 实施步骤 (Implementation Roadmap)
建议分三个阶段实施：

阶段一：基础架构与权益限制 (Infrastructure & Gating)

1. 数据库迁移 ：添加会员相关字段。
2. 后端逻辑 ：在添加鹦鹉、查看高级图表等接口加入“权限检查”逻辑。
3. Mock 支付 ：先不接真实支付，开发一个“兑换码”或“管理员后台开通”功能，用于内部测试和种子用户赠送。
阶段二：支付接入 (Payment Integration)

1. 微信支付对接 ：注册微信支付商户号，后端实现统一下单和回调接口。
2. 订单系统 ：实现订单创建、状态流转。
阶段三：前端展示与引导 (UI & Upsell)

1. 会员中心页 ：展示当前身份、过期时间、续费按钮。
2. 权益墙 (Paywall) ：当用户点击“添加第6只鹦鹉”或“导出报表”时，弹出精美的会员介绍弹窗。
3. UI 标识 ：在头像旁增加 PRO 金色标识，增加尊贵感。